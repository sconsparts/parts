Import('*')
PartName("part3")

copyed = env.CCopy(
    source=env.Pattern(recursive=False),
    target="$BUILD_DIR/build"
)

outdir = env.CCommand(
    "destdir",
    copyed,
    [
        Delete("$TARGET"), # this clean the install directory so we get a clean scan
        "cd ${SOURCE.dir} && scons install --destdir=${TARGET.abspath} CC=$CC CXX=$CXX"
    ],
    target_factory=env.Dir,
    #source_scanner=SourceScanner(Pattern(src_dir="destdir",includes=["*.hpp"])),
    #target_scanner=SourceScanner(Pattern(src_dir="destdir"))
    target_scanner=env.ScanDirectory("destdir",)
)
env.Clean(outdir,outdir)
