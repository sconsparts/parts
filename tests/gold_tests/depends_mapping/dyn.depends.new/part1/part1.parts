Import('*')

env.PartName("part1")

@build
def source(env):

    copyed = env.CCopy(
        source=env.Pattern(recursive=False),
        target="$BUILD_DIR/build"
    )

    outdir = env.CCommand(
        "destdir",
        copyed,
        [
            Delete("$TARGET"),
            "cd ${SOURCE.dir} && scons -s install --destdir=${TARGET.abspath} CC=$CC CXX=$CXX"
        ],
        source_scanner=NullScanner,
        target_factory=env.Dir,
        target_scanner=env.ScanDirectory("destdir",)
    )
    env.Clean(outdir,outdir)


